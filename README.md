# 🔬 基于改进型 TCN 模型的构件链预测研究

## 🧪 实验环境

- **PyTorch**：1.10.2+cpu  
- **Scikit-learn**：0.24.2  
- **NumPy**：1.19.5  
- **TensorFlow**：2.6.2  
- **Pandas**：1.1.5  

---

## 📊 实验背景与目的

随着软件系统复杂度的不断提高，构件化开发凭借其良好的可复用性与高效性，逐渐成为主流的开发方式。构件链预测作为构件推荐的重要任务，可有效减少重复劳动、提升开发效率。

本研究尝试利用深度学习方法，特别是 **时间卷积网络（TCN）**，对构件链进行建模与预测，以期提升构件化开发中的智能化水平和推荐准确性。

---

## 📁 数据集简介

- **数据来源**：来自 *核格集成开发平台* 的 `.pix` 文件，解析后转换为 `.xml` 格式  
- **数据内容**：通过解析 XML 文件获取构件调用链，并整理为构件链表格数据

### 数据处理流程：

- 遍历 XML 节点提取构件调用关系  
- 处理分支、循环等结构节点  
- 替代缺失或无效构件标识  
- 使用自定义规则映射构件 ID

---

## ⚙️ 数据预处理流程

1. **文本序列转整数序列**（Tokenizer 编码）  
2. **样本构建**：  
   - 输入：去除每条构件链的最后一个构件  
   - 标签：每条链的最后一个构件  
3. **序列填充**：统一输入长度  
4. **数据划分**：训练集 : 测试集 = 7 : 3  
5. **格式转换**：保存为 `.pth` 文件以供模型加载

---

## 🧩 模型对比实验

| 模型      | 测试集 Loss | 测试集准确率 | 精确率     | 召回率     | F1 分数    |
|-----------|-------------|---------------|------------|------------|------------|
| BiLSTM    | 0.0977      | 0.9647        | 0.7990     | 0.5757     | 0.8156     |
| LSTM      | 0.1176      | 0.9686        | 0.9481     | 0.3713     | 0.8416     |
| RNN       | 0.2169      | 0.9246        | 0.3981     | 0.0088     | 0.5695     |
| **TCN**   | **0.0635**  | **0.9800**    | **0.9341** | **0.6647** | **0.8984** |

> ✅ TCN 模型在多个指标上表现最佳，作为后续改进的基础模型。

---

## 🚀 改进型 TCN 网络结构设计

为进一步提升模型性能，本文提出了一种**改进型 TCN 网络结构**，集成了以下关键模块：

- **GRU 单元**  
- **动态稀疏注意力层（AttentionZeroedLayer）**  
- **Chomp1d 层**

### 🔧 各模块功能说明

- **Embedding Layer**：将构件 ID 编码为稠密向量，捕捉构件间的语义关系  
- **GRU 模块**：增强对构件序列中长期依赖的建模能力，缓解梯度消失问题  
- **AttentionZeroedLayer**：利用可学习的注意力权重，对输入进行动态稀疏化，过滤掉无效信息  
- **Chomp1d**：修剪卷积引入的多余长度，保持时间信息一致性

---

### 🧪 改进模型实验结果

| 指标         | 数值     |
|--------------|----------|
| Loss         | 0.0329   |
| 准确率       | 0.9913   |
| 精确率       | 0.9797   |
| 召回率       | 0.8192   |
| F1 分数      | 0.9553   |

> 💡 相比原始 TCN 模型，改进后的模型在保持高精度的同时，大幅提升了召回率，显著增强了模型对构件使用模式的覆盖能力。

---

## ✅ 最终结论

本研究探索了基于 TCN 模型的构件链预测方法，并在与多种序列建模模型的比较中表现出较好的效果。通过引入 GRU 模块与注意力稀疏机制，模型在保持准确率的同时，提升了对构件使用模式的覆盖能力。

整体来看，该方法可为构件化开发中的构件推荐提供一定的参考，有助于改善重复开发问题，提高开发效率。
